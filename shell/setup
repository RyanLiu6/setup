#!/bin/bash
set -e

SETUP_DIR="${SETUP_DIR:-$HOME/dev/setup}"

echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo "Shell Configuration Setup"
echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
echo ""

echo "üìù Copying shell configuration files..."
echo ""

# Copy shell config files
if [[ -f "$SETUP_DIR/shell/.zprofile" ]]; then
    cp "$SETUP_DIR/shell/.zprofile" ~/.zprofile
    echo "  ‚úì Copied .zprofile to home directory"
fi

cp "$SETUP_DIR/shell/.zshrc" ~/.zshrc
echo "  ‚úì Copied .zshrc to home directory"

echo ""

# Change default shell to zsh if not already
if [[ "$SHELL" != "/bin/zsh" ]]; then
    # Skip chsh in CI environments where it requires interactive password input
    if [[ -n "$CI" || -n "$GITHUB_ACTIONS" ]]; then
        echo "‚ÑπÔ∏è  Skipping shell change in CI environment"
    else
        echo "üêö Changing default shell to zsh..."
        if chsh -s /bin/zsh 2>/dev/null; then
            echo "‚úì Default shell changed to zsh"
        else
            echo "‚ö†Ô∏è  Could not change default shell (may require password or sudo)"
            echo "   You can manually change it later with: chsh -s /bin/zsh"
        fi
    fi
else
    echo "‚úì Default shell is already zsh"
fi

echo ""
echo "‚úì Shell configuration complete!"
echo ""
